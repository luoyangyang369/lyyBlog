<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>I/O 多路复用，select / poll / epoll 详解 | 罗洋洋的博客</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="">
    <meta name="description" content="罗洋洋的博客">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/assets/css/0.styles.10342b57.css" as="style"><link rel="preload" href="/assets/js/app.9b6c21b2.js" as="script"><link rel="preload" href="/assets/js/3.5e4ac8fc.js" as="script"><link rel="preload" href="/assets/js/1.3c5103ae.js" as="script"><link rel="preload" href="/assets/js/14.1f60fcc8.js" as="script"><link rel="prefetch" href="/assets/js/10.6758011f.js"><link rel="prefetch" href="/assets/js/11.066a8c2d.js"><link rel="prefetch" href="/assets/js/12.29a6d7b4.js"><link rel="prefetch" href="/assets/js/13.8977b0ce.js"><link rel="prefetch" href="/assets/js/15.a4900de2.js"><link rel="prefetch" href="/assets/js/16.6a9b71a3.js"><link rel="prefetch" href="/assets/js/17.1c9dd20d.js"><link rel="prefetch" href="/assets/js/18.6965c846.js"><link rel="prefetch" href="/assets/js/19.4830de0c.js"><link rel="prefetch" href="/assets/js/20.65024843.js"><link rel="prefetch" href="/assets/js/21.ac27e851.js"><link rel="prefetch" href="/assets/js/22.aaa988a7.js"><link rel="prefetch" href="/assets/js/23.9804f4dd.js"><link rel="prefetch" href="/assets/js/24.ead76f46.js"><link rel="prefetch" href="/assets/js/25.d09db6c2.js"><link rel="prefetch" href="/assets/js/26.b90a7aac.js"><link rel="prefetch" href="/assets/js/27.2b0894ce.js"><link rel="prefetch" href="/assets/js/28.752c772a.js"><link rel="prefetch" href="/assets/js/29.a824919a.js"><link rel="prefetch" href="/assets/js/30.f29f244c.js"><link rel="prefetch" href="/assets/js/31.6f8dd52c.js"><link rel="prefetch" href="/assets/js/32.5cc6a177.js"><link rel="prefetch" href="/assets/js/33.c2e9b6ad.js"><link rel="prefetch" href="/assets/js/34.9cd986ef.js"><link rel="prefetch" href="/assets/js/35.34069a89.js"><link rel="prefetch" href="/assets/js/36.1ce217ae.js"><link rel="prefetch" href="/assets/js/37.cf1ca407.js"><link rel="prefetch" href="/assets/js/38.d24f1a9b.js"><link rel="prefetch" href="/assets/js/39.2832e1d2.js"><link rel="prefetch" href="/assets/js/4.4c1c221d.js"><link rel="prefetch" href="/assets/js/40.19561629.js"><link rel="prefetch" href="/assets/js/41.e586fe58.js"><link rel="prefetch" href="/assets/js/42.543626a8.js"><link rel="prefetch" href="/assets/js/43.22e541da.js"><link rel="prefetch" href="/assets/js/44.22ae2674.js"><link rel="prefetch" href="/assets/js/45.3e886d27.js"><link rel="prefetch" href="/assets/js/46.a2e7d5a6.js"><link rel="prefetch" href="/assets/js/47.897227ef.js"><link rel="prefetch" href="/assets/js/48.84cb6a60.js"><link rel="prefetch" href="/assets/js/49.7ad656dc.js"><link rel="prefetch" href="/assets/js/5.ce210c74.js"><link rel="prefetch" href="/assets/js/50.69ca170f.js"><link rel="prefetch" href="/assets/js/51.e25d866d.js"><link rel="prefetch" href="/assets/js/52.681b70c5.js"><link rel="prefetch" href="/assets/js/53.98e92595.js"><link rel="prefetch" href="/assets/js/54.3dc253f8.js"><link rel="prefetch" href="/assets/js/55.c1424ab2.js"><link rel="prefetch" href="/assets/js/56.8dce0004.js"><link rel="prefetch" href="/assets/js/57.80309b1d.js"><link rel="prefetch" href="/assets/js/58.9811eb00.js"><link rel="prefetch" href="/assets/js/59.31ae2884.js"><link rel="prefetch" href="/assets/js/6.794ba8eb.js"><link rel="prefetch" href="/assets/js/60.c69d9b9b.js"><link rel="prefetch" href="/assets/js/61.999de4a9.js"><link rel="prefetch" href="/assets/js/62.0ec7bfbf.js"><link rel="prefetch" href="/assets/js/63.6c8260a9.js"><link rel="prefetch" href="/assets/js/64.b22d6c32.js"><link rel="prefetch" href="/assets/js/65.2d534f65.js"><link rel="prefetch" href="/assets/js/66.ae3a7fd2.js"><link rel="prefetch" href="/assets/js/67.0365faaf.js"><link rel="prefetch" href="/assets/js/68.39326481.js"><link rel="prefetch" href="/assets/js/69.150bf053.js"><link rel="prefetch" href="/assets/js/7.bb4a6ee8.js"><link rel="prefetch" href="/assets/js/70.2a8b1d1a.js"><link rel="prefetch" href="/assets/js/71.afca1da8.js"><link rel="prefetch" href="/assets/js/72.59374e17.js"><link rel="prefetch" href="/assets/js/73.b0b030af.js"><link rel="prefetch" href="/assets/js/74.3453834e.js"><link rel="prefetch" href="/assets/js/75.5a156cf6.js"><link rel="prefetch" href="/assets/js/76.a378d2a3.js"><link rel="prefetch" href="/assets/js/77.76d0df5e.js"><link rel="prefetch" href="/assets/js/78.ffaf13eb.js"><link rel="prefetch" href="/assets/js/79.3aba8bb4.js"><link rel="prefetch" href="/assets/js/8.c75cece5.js"><link rel="prefetch" href="/assets/js/9.ecb33a99.js">
    <link rel="stylesheet" href="/assets/css/0.styles.10342b57.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar" data-v-1156296a><div data-v-1156296a><div id="loader-wrapper" class="loading-wrapper" data-v-d48f4d20 data-v-1156296a data-v-1156296a><div class="loader-main" data-v-d48f4d20><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-4e82dffc data-v-1156296a data-v-1156296a><h3 class="title" data-v-4e82dffc data-v-4e82dffc>罗洋洋的博客</h3> <p class="description" data-v-4e82dffc data-v-4e82dffc>罗洋洋的博客</p> <label id="box" class="inputBox" data-v-4e82dffc data-v-4e82dffc><input type="password" value="" data-v-4e82dffc> <span data-v-4e82dffc>Konck! Knock!</span> <button data-v-4e82dffc>OK</button></label> <div class="footer" data-v-4e82dffc data-v-4e82dffc><span data-v-4e82dffc><i class="iconfont reco-theme" data-v-4e82dffc></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-4e82dffc>vuePress-theme-reco</a></span> <span data-v-4e82dffc><i class="iconfont reco-copyright" data-v-4e82dffc></i> <a data-v-4e82dffc><span data-v-4e82dffc>luoyangyang</span>
            
          <span data-v-4e82dffc>2018 - </span>
          2021
        </a></span></div></div> <div class="hide" data-v-1156296a><header class="navbar" data-v-1156296a><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">罗洋洋的博客</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/Linux/" class="nav-link"><i class="undefined"></i>
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/categories/计算机基础/" class="nav-link"><i class="undefined"></i>
  计算机基础
</a></li><li class="dropdown-item"><!----> <a href="/categories/数据结构/" class="nav-link"><i class="undefined"></i>
  数据结构
</a></li><li class="dropdown-item"><!----> <a href="/categories/MySQL/" class="nav-link"><i class="undefined"></i>
  MySQL
</a></li><li class="dropdown-item"><!----> <a href="/categories/运维/" class="nav-link"><i class="undefined"></i>
  运维
</a></li><li class="dropdown-item"><!----> <a href="/categories/其他/" class="nav-link"><i class="undefined"></i>
  其他
</a></li><li class="dropdown-item"><!----> <a href="/categories/面试/" class="nav-link"><i class="undefined"></i>
  面试
</a></li><li class="dropdown-item"><!----> <a href="/categories/Java/" class="nav-link"><i class="undefined"></i>
  Java
</a></li><li class="dropdown-item"><!----> <a href="/categories/工具/" class="nav-link"><i class="undefined"></i>
  工具
</a></li><li class="dropdown-item"><!----> <a href="/categories/Node/" class="nav-link"><i class="undefined"></i>
  Node
</a></li><li class="dropdown-item"><!----> <a href="/categories/Python/" class="nav-link"><i class="undefined"></i>
  Python
</a></li><li class="dropdown-item"><!----> <a href="/categories/算法/" class="nav-link"><i class="undefined"></i>
  算法
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  归档
</a></div><div class="nav-item"><a href="/posts/interview/learn.html" class="nav-link"><i class="undefined"></i>
  学习
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      参考资料
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://doocs.github.io/#/README_CN" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  doccs
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="http://www.cyc2018.xyz/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  CS-Notes
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      高级
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>博客</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/posts/vuepress/vuepress.html" class="nav-link"><i class="undefined"></i>
  vuepress
</a></li></ul></li><li class="dropdown-item"><h4>Java</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/posts/java/general.html" class="nav-link"><i class="undefined"></i>
  基础知识
</a></li><li class="dropdown-subitem"><a href="/posts/java/spring.html" class="nav-link"><i class="undefined"></i>
  spring
</a></li></ul></li><li class="dropdown-item"><h4>面试</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/posts/interview/interview.html" class="nav-link"><i class="undefined"></i>
  面试题
</a></li><li class="dropdown-subitem"><a href="/posts/interview/interview2.html" class="nav-link"><i class="undefined"></i>
  面试题总结
</a></li></ul></li></ul></div></div> <a href="https://github.com/luoyangyang369" target="_blank" rel="noopener noreferrer" class="repo-link"><i class="iconfont reco-github"></i>
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask" data-v-1156296a></div> <aside class="sidebar" data-v-1156296a><div class="personal-info-wrapper" data-v-828910c6 data-v-1156296a><img src="/img/header.jpeg" alt="author-avatar" class="personal-img" data-v-828910c6> <h3 class="name" data-v-828910c6>
    luoyangyang
  </h3> <div class="num" data-v-828910c6><div data-v-828910c6><h3 data-v-828910c6>67</h3> <h6 data-v-828910c6>Articles</h6></div> <div data-v-828910c6><h3 data-v-828910c6>37</h3> <h6 data-v-828910c6>Tags</h6></div></div> <ul class="social-links" data-v-828910c6><li class="social-item" data-v-828910c6><i class="iconfont reco-github" style="color:#f8b26a;" data-v-828910c6></i></li><li class="social-item" data-v-828910c6><i class="iconfont reco-sf" style="color:#fb9b5f;" data-v-828910c6></i></li></ul> <hr data-v-828910c6></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/Linux/" class="nav-link"><i class="undefined"></i>
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/categories/计算机基础/" class="nav-link"><i class="undefined"></i>
  计算机基础
</a></li><li class="dropdown-item"><!----> <a href="/categories/数据结构/" class="nav-link"><i class="undefined"></i>
  数据结构
</a></li><li class="dropdown-item"><!----> <a href="/categories/MySQL/" class="nav-link"><i class="undefined"></i>
  MySQL
</a></li><li class="dropdown-item"><!----> <a href="/categories/运维/" class="nav-link"><i class="undefined"></i>
  运维
</a></li><li class="dropdown-item"><!----> <a href="/categories/其他/" class="nav-link"><i class="undefined"></i>
  其他
</a></li><li class="dropdown-item"><!----> <a href="/categories/面试/" class="nav-link"><i class="undefined"></i>
  面试
</a></li><li class="dropdown-item"><!----> <a href="/categories/Java/" class="nav-link"><i class="undefined"></i>
  Java
</a></li><li class="dropdown-item"><!----> <a href="/categories/工具/" class="nav-link"><i class="undefined"></i>
  工具
</a></li><li class="dropdown-item"><!----> <a href="/categories/Node/" class="nav-link"><i class="undefined"></i>
  Node
</a></li><li class="dropdown-item"><!----> <a href="/categories/Python/" class="nav-link"><i class="undefined"></i>
  Python
</a></li><li class="dropdown-item"><!----> <a href="/categories/算法/" class="nav-link"><i class="undefined"></i>
  算法
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  归档
</a></div><div class="nav-item"><a href="/posts/interview/learn.html" class="nav-link"><i class="undefined"></i>
  学习
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      参考资料
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://doocs.github.io/#/README_CN" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  doccs
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="http://www.cyc2018.xyz/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  CS-Notes
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      高级
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>博客</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/posts/vuepress/vuepress.html" class="nav-link"><i class="undefined"></i>
  vuepress
</a></li></ul></li><li class="dropdown-item"><h4>Java</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/posts/java/general.html" class="nav-link"><i class="undefined"></i>
  基础知识
</a></li><li class="dropdown-subitem"><a href="/posts/java/spring.html" class="nav-link"><i class="undefined"></i>
  spring
</a></li></ul></li><li class="dropdown-item"><h4>面试</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/posts/interview/interview.html" class="nav-link"><i class="undefined"></i>
  面试题
</a></li><li class="dropdown-subitem"><a href="/posts/interview/interview2.html" class="nav-link"><i class="undefined"></i>
  面试题总结
</a></li></ul></li></ul></div></div> <a href="https://github.com/luoyangyang369" target="_blank" rel="noopener noreferrer" class="repo-link"><i class="iconfont reco-github"></i>
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav> <!----> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-4e82dffc data-v-1156296a><h3 class="title" data-v-4e82dffc data-v-4e82dffc>I/O 多路复用，select / poll / epoll 详解</h3> <!----> <label id="box" class="inputBox" data-v-4e82dffc data-v-4e82dffc><input type="password" value="" data-v-4e82dffc> <span data-v-4e82dffc>Konck! Knock!</span> <button data-v-4e82dffc>OK</button></label> <div class="footer" data-v-4e82dffc data-v-4e82dffc><span data-v-4e82dffc><i class="iconfont reco-theme" data-v-4e82dffc></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-4e82dffc>vuePress-theme-reco</a></span> <span data-v-4e82dffc><i class="iconfont reco-copyright" data-v-4e82dffc></i> <a data-v-4e82dffc><span data-v-4e82dffc>luoyangyang</span>
            
          <span data-v-4e82dffc>2018 - </span>
          2021
        </a></span></div></div> <div data-v-1156296a><main class="page"><section><div class="page-title"><h1 class="title">I/O 多路复用，select / poll / epoll 详解</h1> <div data-v-1ff7123e><i class="iconfont reco-account" data-v-1ff7123e><span data-v-1ff7123e>luoyangyang</span></i> <i class="iconfont reco-date" data-v-1ff7123e><span data-v-1ff7123e>6/12/2021</span></i> <i class="iconfont reco-eye" data-v-1ff7123e><span id="/posts/Linux/select.html" data-flag-title="Your Article Title" class="leancloud-visitors" data-v-1ff7123e><a class="leancloud-visitors-count" style="font-size:.9rem;font-weight:normal;color:#999;"></a></span></i> <i class="tags iconfont reco-tag" data-v-1ff7123e><span class="tag-item" data-v-1ff7123e>Linux</span></i></div></div> <div class="theme-reco-content content__default"><h2 id="参考"><a href="#参考" class="header-anchor">#</a> 参考</h2> <p>-<a href="https://imageslr.com/2020/02/27/select-poll-epoll.html#poll" target="_blank" rel="noopener noreferrer">I/O 多路复用，select / poll / epoll 详解<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="从阻塞-i-o-到-i-o-多路复用"><a href="#从阻塞-i-o-到-i-o-多路复用" class="header-anchor">#</a> 从阻塞 I/O 到 I/O 多路复用</h2> <p>阻塞 I/O，是指进程发起调用后，会被挂起（阻塞），直到收到数据再返回。如果调用一直不返回，进程就会一直被挂起。因此，当使用阻塞 I/O 时，需要使用多线程来处理多个文件描述符。</p> <p>多线程切换有一定的开销，因此引入非阻塞 I/O。非阻塞 I/O 不会将进程挂起，调用时会立即返回成功或错误，因此可以在一个线程里轮询多个文件描述符是否就绪。</p> <p>但是非阻塞 I/O 的缺点是：每次发起系统调用，只能检查一个文件描述符是否就绪。当文件描述符很多时，系统调用的成本很高。</p> <p>因此引入了 I/O 多路复用，可以通过一次系统调用，检查多个文件描述符的状态。这是 I/O 多路复用的主要优点，相比于非阻塞 I/O，在文件描述符较多的场景下，避免了频繁的用户态和内核态的切换，减少了系统调用的开销。</p> <blockquote><p>I/O 多路复用相当于将「遍历所有文件描述符、通过非阻塞 I/O 查看其是否就绪」的过程从用户线程移到了内核中，由内核来负责轮询。</p></blockquote> <p>进程可以通过 select、poll、epoll 发起 I/O 多路复用的系统调用，这些系统调用都是同步阻塞的：<strong>如果传入的多个文件描述符中，有描述符就绪，则返回就绪的描述符；否则如果所有文件描述符都未就绪，就阻塞调用进程，直到某个描述符就绪，或者阻塞时长超过设置的 timeout 后，再返回。</strong> 使用非阻塞 I/O 检查每个描述符的就绪状态。</p> <p>如果 <code>timeout</code> 参数设为 NULL，会无限阻塞直到某个描述符就绪；如果 <code>timeout</code> 参数设为 0，会立即返回，不阻塞。</p> <p>I/O 多路复用引入了一些额外的操作和开销，性能更差。但是好处是用户可以在一个线程内同时处理多个 I/O 请求。如果不采用 I/O 多路复用，则必须通过多线程的方式，每个线程处理一个 I/O 请求。后者线程切换也是有一定的开销的。这部分内容可以查看最下文 <code>Redis 的线程模型</code>。</p> <h2 id="为什么-i-o-多路复用内部需要使用非阻塞-i-o"><a href="#为什么-i-o-多路复用内部需要使用非阻塞-i-o" class="header-anchor">#</a> 为什么 I/O 多路复用内部需要使用非阻塞 I/O</h2> <p>I/O 多路复用<code>内部</code>会遍历集合中的每个文件描述符，判断其是否就绪：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>for fd in read_set
    if（ readable(fd) ) // 判断 fd 是否就绪
        count++
        FDSET(fd, &amp;res_rset) // 将 fd 添加到就绪集合中
        break
...
return count
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>这里的 readable(fd) 就是一个非阻塞 I/O 调用。试想，如果这里使用阻塞 I/O，那么 fd 未就绪时，select 会阻塞在这个文件描述符上，无法检查下个文件描述符。</p> <p>注意：这里说的是 I/O 多路复用的内部实现，而不是说，使用 I/O 多路复用就必须使用非阻塞 I/O，见下文 <code>为什么边缘触发必须使用非阻塞 I/O</code>。</p> <h2 id="select"><a href="#select" class="header-anchor">#</a> select</h2> <h3 id="函数签名与参数"><a href="#函数签名与参数" class="header-anchor">#</a> 函数签名与参数</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>int select(int nfds,
            fd_set *restrict readfds,
            fd_set *restrict writefds,
            fd_set *restrict errorfds,
            struct timeval *restrict timeout);
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><code>readfds</code>、<code>writefds</code>、<code>errorfds</code> 是三个文件描述符集合。<code>select</code> 会遍历每个集合的前 <code>nfds</code> 个描述符，分别找到可以读取、可以写入、发生错误的描述符，统称为“就绪”的描述符。然后用找到的子集替换参数中的对应集合，返回所有就绪描述符的总数。</p> <p><code>timeout</code> 参数表示调用 <code>select</code> 时的阻塞时长。如果所有文件描述符都未就绪，就阻塞调用进程，直到某个描述符就绪，或者阻塞超过设置的 <code>timeout</code> 后，返回。如果 <code>timeout</code> 参数设为 NULL，会无限阻塞直到某个描述符就绪；如果 <code>timeout</code> 参数设为 0，会立即返回，不阻塞。</p> <h3 id="什么是文件描述符-fd"><a href="#什么是文件描述符-fd" class="header-anchor">#</a> 什么是文件描述符 fd</h3> <p><code>文件描述符（file descriptor）</code>是一个非负整数，从 0 开始。进程使用文件描述符来标识一个打开的文件。</p> <p>系统为每一个进程维护了一个文件描述符表，表示该进程打开文件的记录表，而<strong>文件描述符实际上就是这张表的索引</strong>。当进程打开（open）或者新建（create）文件时，内核会在该进程的文件列表中新增一个表项，同时返回一个文件描述符 —— 也就是新增表项的下标。</p> <p>一般来说，每个进程最多可以打开 64 个文件，fd ∈ 0~63。在不同系统上，最多允许打开的文件个数不同，Linux 2.4.22 强制规定最多不能超过 1,048,576。</p> <p>每个进程默认都有 3 个文件描述符：0 (stdin)、1 (stdout)、2 (stderr)。</p> <p><a href="https://github.com/labuladong/fucking-algorithm/blob/master/%E6%8A%80%E6%9C%AF/linux%E8%BF%9B%E7%A8%8B.md" target="_blank" rel="noopener noreferrer">这篇文章<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>以图示的方式对文件描述符作了深入地讲解，可以进一步阅读。</p> <h3 id="socket-与-fd-的关系"><a href="#socket-与-fd-的关系" class="header-anchor">#</a> socket 与 fd 的关系</h3> <p>socket 是 Unix 中的术语。socket 可以用于同一台主机的不同进程间的通信，也可以用于不同主机间的通信。一个 socket 包含地址、类型和通信协议等信息，通过 socket() 函数创建：</p> <p><code>int socket(int domain, int type, int protocol)</code></p> <p>返回的就是这个 socket 对应的文件描述符 fd。操作系统将 socket 映射到进程的一个文件描述符上，进程就可以通过读写这个文件描述符来和远程主机通信。</p> <p>可以这样理解：socket 是进程间通信规则的高层抽象，而 fd 提供的是底层的具体实现。socket 与 fd 是一一对应的。通过 socket 通信，实际上就是通过文件描述符 fd 读写文件。这也符合 Unix“一切皆文件”的哲学。</p> <p>后面可以将 socket 和 fd 视为同义词。</p> <h2 id="fd-set-文件描述符集合"><a href="#fd-set-文件描述符集合" class="header-anchor">#</a> fd_set 文件描述符集合</h2> <p>参数中的 <code>fd_set</code> 类型表示文件描述符的集合。</p> <p>由于文件描述符 <code>fd</code> 是一个从 0 开始的无符号整数，所以可以使用 <code>fd_set</code> 的二进制每一位来表示一个文件描述符。某一位为 1，表示对应的文件描述符已就绪。比如比如设 <code>fd_set</code> 长度为 1 字节，则一个 <code>fd_set</code> 变量最大可以表示 8 个文件描述符。当 <code>select</code> 返回 <code>fd_set = 00010011</code> 时，表示文件描述符 1、2、5 已经就绪。</p> <p>fd_set 的使用涉及以下几个 API：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#include &lt;sys/select.h&gt;   
int FD_ZERO(int fd, fd_set *fdset);  // 将 fd_set 所有位置 0
int FD_CLR(int fd, fd_set *fdset);   // 将 fd_set 某一位置 0
int FD_SET(int fd, fd_set *fd_set);  // 将 fd_set 某一位置 1
int FD_ISSET(int fd, fd_set *fdset); // 检测 fd_set 某一位是否为 1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="select-使用示例"><a href="#select-使用示例" class="header-anchor">#</a> select 使用示例</h3> <p>下图的代码说明：</p> <ol><li>先声明一个 fd_set 类型的变量 readFDs</li> <li>调用 FD_ZERO，将 readFDs 所有位置 0</li> <li>调用 FD_SET，将 readFDs 感兴趣的位置 1，表示要监听这几个文件描述符</li> <li>将 readFDs 传给 select，调用 select</li> <li>select 会将 readFDs 中就绪的位置 1，未就绪的位置 0，返回就绪的文件描述符的数量</li> <li>当 select 返回后，调用 FD_ISSET 检测给定位是否为 1，表示对应文件描述符是否就绪</li></ol> <p>比如进程想监听 1、2、5 这三个文件描述符，就将 <code>readFDs</code> 设置为 00010011，然后调用 <code>select</code>。</p> <p>如果 fd=1、fd=2 就绪，而 fd=5 未就绪，select 会将 <code>readFDs</code> 设置为 00000011 并返回 2。</p> <p>如果每个文件描述符都未就绪，select 会阻塞 timeout 时长，再返回。这期间，如果 <code>readFDs</code> 监听的某个文件描述符上发生可读事件，则 select 会将对应位置 1，并立即返回。</p> <h3 id="select-的缺点"><a href="#select-的缺点" class="header-anchor">#</a> select 的缺点</h3> <ol><li><p>性能开销大</p> <ol><li>调用 <code>select</code> 时会陷入内核，这时需要将参数中的 <code>fd_set</code> 从用户空间拷贝到内核空间</li> <li>内核需要遍历传递进来的所有 <code>fd_set</code> 的每一位，不管它们是否就绪</li></ol></li> <li><p>同时能够监听的文件描述符数量太少。受限于 <code>sizeof(fd_set)</code> 的大小，在编译内核时就确定了且无法更改。一般是 1024，不同的操作系统不相同</p></li></ol> <h2 id="poll"><a href="#poll" class="header-anchor">#</a> poll</h2> <p>poll 和 select 几乎没有区别。poll 采用链表的方式存储文件描述符，没有最大存储数量的限制。</p> <p>从性能开销上看，poll 和 select 的差别不大。</p> <h2 id="epoll"><a href="#epoll" class="header-anchor">#</a> epoll</h2> <p>epoll 是对 select 和 poll 的改进，避免了“性能开销大”和“文件描述符数量少”两个缺点。</p> <p>简而言之，epoll 有以下几个特点：</p> <ul><li>使用<strong>红黑树</strong>存储文件描述符集合</li> <li>使用<strong>队列</strong>存储就绪的文件描述符</li> <li>每个文件描述符只需在添加时传入一次；通过事件更改文件描述符状态</li></ul> <p>select、poll 模型都只使用一个函数，而 epoll 模型使用三个函数：<code>epoll_create</code>、<code>epoll_ctl</code> 和 <code>epoll_wait</code>。</p> <h3 id="epoll-create"><a href="#epoll-create" class="header-anchor">#</a> epoll_create</h3> <blockquote><p>int epoll_create(int size);
<code>epoll_create</code> 会创建一个 <code>epoll</code> 实例，同时返回一个引用该实例的文件描述符。</p></blockquote> <p>返回的文件描述符仅仅指向对应的 <code>epoll</code> 实例，并不表示真实的磁盘文件节点。其他 API 如 <code>epoll_ctl</code>、<code>epoll_wait</code> 会使用这个文件描述符来操作相应的 <code>epoll</code> 实例。</p> <p>当创建好 <code>epoll</code> 句柄后，它会占用一个 fd 值，在 linux 下查看 /proc/进程id/fd/，就能够看到这个 fd。所以在使用完 <code>epoll</code> 后，必须调用 close(epfd) 关闭对应的文件描述符，否则可能导致 fd 被耗尽。当指向同一个 <code>epoll</code> 实例的所有文件描述符都被关闭后，操作系统会销毁这个 <code>epoll</code> 实例。</p> <p><code>epoll</code> 实例内部存储：</p> <ul><li>监听列表：所有要监听的文件描述符，使用红黑树</li> <li>就绪列表：所有就绪的文件描述符，使用链表</li></ul> <h3 id="epoll-ctl"><a href="#epoll-ctl" class="header-anchor">#</a> epoll_ctl</h3> <blockquote><p>int epoll_ctl(int epfd, int op, int fd, struct epoll_event *event);</p></blockquote> <p>epoll_ctl 会监听文件描述符 fd 上发生的 event 事件。</p> <p>参数说明：</p> <ul><li>epfd 即 epoll_create 返回的文件描述符，指向一个 epoll 实例</li> <li>fd 表示要监听的目标文件描述符</li> <li>event 表示要监听的事件（可读、可写、发送错误…）</li> <li>op 表示要对 fd 执行的操作，有以下几种：
<ul><li>EPOLL_CTL_ADD：为 fd 添加一个监听事件 event</li> <li>EPOLL_CTL_MOD：Change the event event associated with the target file descriptor fd（event 是一个结构体变量，这相当于变量 event 本身没变，但是更改了其内部字段的值）</li> <li>EPOLL_CTL_DEL：删除 fd 的所有监听事件，这种情况下 event 参数没用</li></ul></li></ul> <p>返回值 0 或 -1，表示上述操作成功与否。</p> <p><code>epoll_ctl</code> 会将文件描述符 fd 添加到 <code>epoll</code> 实例的监听列表里，同时为 fd 设置一个回调函数，并监听事件 event。当 fd 上发生相应事件时，会调用回调函数，将 fd 添加到 <code>epoll</code> 实例的就绪队列上。</p> <h3 id="epoll-wait"><a href="#epoll-wait" class="header-anchor">#</a> epoll_wait</h3> <blockquote><p>int epoll_wait(int epfd, struct epoll_event *events, int maxevents, int timeout);
这是 <code>epoll</code> 模型的主要函数，功能相当于 <code>select</code>。</p></blockquote> <p>参数说明：</p> <ul><li>epfd 即 epoll_create 返回的文件描述符，指向一个 epoll 实例</li> <li>events 是一个数组，保存就绪状态的文件描述符，其空间由调用者负责申请</li> <li>maxevents 指定 events 的大小</li> <li>timeout 类似于 select 中的 timeout。如果没有文件描述符就绪，即就绪队列为空，则 epoll_wait 会阻塞 timeout 毫秒。如果 timeout 设为 -1，则 epoll_wait 会一直阻塞，直到有文件描述符就绪；如果 timeout 设为 0，则 epoll_wait 会立即返回</li></ul> <p>返回值表示 events 中存储的就绪描述符个数，最大不超过 maxevents。</p> <h3 id="epoll-的优点"><a href="#epoll-的优点" class="header-anchor">#</a> epoll 的优点</h3> <p>一开始说，epoll 是对 select 和 poll 的改进，避免了“性能开销大”和“文件描述符数量少”两个缺点。</p> <p>对于“文件描述符数量少”，select 使用整型数组存储文件描述符集合，而 epoll 使用红黑树存储，数量较大。</p> <p>对于“性能开销大”，epoll_ctl 中为每个文件描述符指定了回调函数，并在就绪时将其加入到就绪列表，因此 epoll 不需要像 select 那样遍历检测每个文件描述符，只需要判断就绪列表是否为空即可。这样，在没有描述符就绪时，epoll 能更早地让出系统资源。</p> <blockquote><blockquote><p>相当于时间复杂度从 O(n) 降为 O(1)</p></blockquote></blockquote> <p>此外，每次调用 select 时都需要向内核拷贝所有要监听的描述符集合，而 epoll 对于每个描述符，只需要在 epoll_ctl 传递一次，之后 epoll_wait 不需要再次传递。这也大大提高了效率。</p> <h2 id="水平触发、边缘触发"><a href="#水平触发、边缘触发" class="header-anchor">#</a> 水平触发、边缘触发</h2> <p>select 只支持水平触发，epoll 支持水平触发和边缘触发。</p> <ul><li><p>水平触发（LT，Level Trigger）：当文件描述符就绪时，会触发通知，如果用户程序没有一次性把数据读/写完，下次还会发出可读/可写信号进行通知。</p></li> <li><p>边缘触发（ET，Edge Trigger）：仅当描述符从未就绪变为就绪时，通知一次，之后不会再通知。</p></li></ul> <p>区别：边缘触发效率更高，<strong>减少了事件被重复触发的次数</strong>，函数不会返回大量用户程序可能不需要的文件描述符。</p> <blockquote><p>水平触发、边缘触发的名称来源：数字电路当中的电位水平，高低电平切换瞬间的触发动作叫边缘触发，而处于高电平的触发动作叫做水平触发。</p></blockquote> <h2 id="为什么边缘触发必须使用非阻塞-i-o"><a href="#为什么边缘触发必须使用非阻塞-i-o" class="header-anchor">#</a> 为什么边缘触发必须使用非阻塞 I/O？</h2> <ul><li>每次通过 read 系统调用读取数据时，最多只能读取缓冲区大小的字节数；如果某个文件描述符一次性收到的数据超过了缓冲区的大小，那么需要对其 read 多次才能全部读取完毕</li> <li><strong><code>select</code> 可以使用阻塞 I/O</strong>。通过 select 获取到所有可读的文件描述符后，遍历每个文件描述符，read 一次数据（见上文 select 示例）
<ul><li>这些文件描述符都是可读的，因此即使 read 是阻塞 I/O，也一定可以读到数据，不会一直阻塞下去</li> <li>select 采用水平触发模式，因此如果第一次 read 没有读取完全部数据，那么下次调用 select 时依然会返回这个文件描述符，可以再次 read</li> <li><strong>select 也可以使用非阻塞 I/O</strong>。当遍历某个可读文件描述符时，使用 for 循环调用 read 多次，直到读取完所有数据为止（返回 EWOULDBLOCK）。这样做会多一次 read 调用，但可以减少调用 select 的次数</li></ul></li> <li>在 epoll 的边缘触发模式下，只会在文件描述符的可读/可写状态发生切换时，才会收到操作系统的通知
<ul><li>因此，如果使用 epoll 的边缘触发模式，在收到通知时，必须使用非阻塞 I/O，并且必须循环调用 read 或 write 多次，直到返回 EWOULDBLOCK 为止，然后再调用 epoll_wait 等待操作系统的下一次通知</li> <li>如果没有一次性读/写完所有数据，那么在操作系统看来这个文件描述符的状态没有发生改变，将不会再发起通知，调用 epoll_wait 会使得该文件描述符一直等待下去，服务端也会一直等待客户端的响应，业务流程无法走完</li> <li>这样做的好处是每次调用 epoll_wait 都是有效的——保证数据全部读写完毕了，等待下次通知。在水平触发模式下，如果调用 epoll_wait 时数据没有读/写完毕，会直接返回，再次通知。因此边缘触发能显著减少事件被触发的次数</li> <li>为什么 epoll 的<strong>边缘触发模式不能使用阻塞 I/O</strong>？很显然，边缘触发模式需要循环读/写一个文件描述符的所有数据。如果使用阻塞 I/O，那么一定会在最后一次调用（没有数据可读/写）时阻塞，导致无法正常结束</li></ul></li></ul> <h2 id="三者对比"><a href="#三者对比" class="header-anchor">#</a> 三者对比</h2> <ul><li>select：调用开销大（需要复制集合）；集合大小有限制；需要遍历整个集合找到就绪的描述符</li> <li>poll：poll 采用链表的方式存储文件描述符，没有最大存储数量的限制，其他方面和 select 没有区别</li> <li>epoll：调用开销小（不需要复制）；集合大小无限制；采用回调机制，不需要遍历整个集合
select、poll 都是在用户态维护文件描述符集合，因此每次需要将完整集合传给内核；epoll 由操作系统在内核中维护文件描述符集合，因此只需要在创建的时候传入文件描述符。</li></ul> <p>此外 <code>select</code> 只支持水平触发，<code>epoll</code> 支持边缘触发。</p> <h2 id="适用场景"><a href="#适用场景" class="header-anchor">#</a> 适用场景</h2> <p>当连接数较多并且有很多的不活跃连接时，<code>epoll</code> 的效率比其它两者高很多。当连接数较少并且都十分活跃的情况下，由于 epoll 需要很多回调，因此性能可能低于其它两者。</p> <h2 id="redis-的线程模型"><a href="#redis-的线程模型" class="header-anchor">#</a> Redis 的线程模型</h2> <p><code>Redis</code> 是一个单线程的工作模型，使用 <code>I/O</code> 多路复用来处理客户端的多个连接。为什么 Redis 选择单线程也能效率这么高？</p> <p><code>I/O</code> 设备（如磁盘、网络）等速度远远慢于 CPU，因此引入了多线程技术。当一个线程发起 <code>I/O</code> 请求时，先将它挂起，切换到别的线程；当 <code>I/O</code> 设备就绪时，再切换回该线程。总之，<strong>多线程技术是为了充分利用 CPU 的计算资源，适用于下层存储慢速的场景</strong>。</p> <p>而 redis 是纯内存操作，读写速度非常快。所有的操作都会在内存中完成，不涉及任何 I/O 操作，<strong>因此多线程频繁的上下文切换反而是一种负优化</strong>。Redis 选择基于<strong>非阻塞 I/O 的 I/O 多路复用机制</strong>，在单线程里并发处理客户端的多个连接，减少多线程带来的系统开销，同时也有更好的可维护性，方便开发和调试。</p> <p>不过 redis 在最新的几个版本中也引入了多线程，目的是：</p> <p>异步处理删除操作。当删除超大键值对的时候，单线程内同步地删除可能会阻塞待处理的任务
应对网络 <code>I/O</code> 的场景，网络 <code>I/O</code> 是慢速 <code>I/O</code>。redis6 吞吐量提高了 1 倍</p></div></section> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新: </span> <span class="time">9/27/2021, 5:32:40 PM</span></div></footer> <!----> <div class="comments-wrapper"><!----></div> <ul class="side-bar sub-sidebar-wrapper" style="width:12rem;" data-v-70334359><li class="level-2" data-v-70334359><a href="/posts/Linux/select.html#参考" class="sidebar-link reco-side-参考" data-v-70334359>参考</a></li><li class="level-2" data-v-70334359><a href="/posts/Linux/select.html#从阻塞-i-o-到-i-o-多路复用" class="sidebar-link reco-side-从阻塞-i-o-到-i-o-多路复用" data-v-70334359>从阻塞 I/O 到 I/O 多路复用</a></li><li class="level-2" data-v-70334359><a href="/posts/Linux/select.html#为什么-i-o-多路复用内部需要使用非阻塞-i-o" class="sidebar-link reco-side-为什么-i-o-多路复用内部需要使用非阻塞-i-o" data-v-70334359>为什么 I/O 多路复用内部需要使用非阻塞 I/O</a></li><li class="level-2" data-v-70334359><a href="/posts/Linux/select.html#select" class="sidebar-link reco-side-select" data-v-70334359>select</a></li><li class="level-3" data-v-70334359><a href="/posts/Linux/select.html#函数签名与参数" class="sidebar-link reco-side-函数签名与参数" data-v-70334359>函数签名与参数</a></li><li class="level-3" data-v-70334359><a href="/posts/Linux/select.html#什么是文件描述符-fd" class="sidebar-link reco-side-什么是文件描述符-fd" data-v-70334359>什么是文件描述符 fd</a></li><li class="level-3" data-v-70334359><a href="/posts/Linux/select.html#socket-与-fd-的关系" class="sidebar-link reco-side-socket-与-fd-的关系" data-v-70334359>socket 与 fd 的关系</a></li><li class="level-2" data-v-70334359><a href="/posts/Linux/select.html#fd-set-文件描述符集合" class="sidebar-link reco-side-fd-set-文件描述符集合" data-v-70334359>fd_set 文件描述符集合</a></li><li class="level-3" data-v-70334359><a href="/posts/Linux/select.html#select-使用示例" class="sidebar-link reco-side-select-使用示例" data-v-70334359>select 使用示例</a></li><li class="level-3" data-v-70334359><a href="/posts/Linux/select.html#select-的缺点" class="sidebar-link reco-side-select-的缺点" data-v-70334359>select 的缺点</a></li><li class="level-2" data-v-70334359><a href="/posts/Linux/select.html#poll" class="sidebar-link reco-side-poll" data-v-70334359>poll</a></li><li class="level-2" data-v-70334359><a href="/posts/Linux/select.html#epoll" class="sidebar-link reco-side-epoll" data-v-70334359>epoll</a></li><li class="level-3" data-v-70334359><a href="/posts/Linux/select.html#epoll-create" class="sidebar-link reco-side-epoll-create" data-v-70334359>epoll_create</a></li><li class="level-3" data-v-70334359><a href="/posts/Linux/select.html#epoll-ctl" class="sidebar-link reco-side-epoll-ctl" data-v-70334359>epoll_ctl</a></li><li class="level-3" data-v-70334359><a href="/posts/Linux/select.html#epoll-wait" class="sidebar-link reco-side-epoll-wait" data-v-70334359>epoll_wait</a></li><li class="level-3" data-v-70334359><a href="/posts/Linux/select.html#epoll-的优点" class="sidebar-link reco-side-epoll-的优点" data-v-70334359>epoll 的优点</a></li><li class="level-2" data-v-70334359><a href="/posts/Linux/select.html#水平触发、边缘触发" class="sidebar-link reco-side-水平触发、边缘触发" data-v-70334359>水平触发、边缘触发</a></li><li class="level-2" data-v-70334359><a href="/posts/Linux/select.html#为什么边缘触发必须使用非阻塞-i-o" class="sidebar-link reco-side-为什么边缘触发必须使用非阻塞-i-o" data-v-70334359>为什么边缘触发必须使用非阻塞 I/O？</a></li><li class="level-2" data-v-70334359><a href="/posts/Linux/select.html#三者对比" class="sidebar-link reco-side-三者对比" data-v-70334359>三者对比</a></li><li class="level-2" data-v-70334359><a href="/posts/Linux/select.html#适用场景" class="sidebar-link reco-side-适用场景" data-v-70334359>适用场景</a></li><li class="level-2" data-v-70334359><a href="/posts/Linux/select.html#redis-的线程模型" class="sidebar-link reco-side-redis-的线程模型" data-v-70334359>Redis 的线程模型</a></li></ul></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div></div></div>
    <script src="/assets/js/app.9b6c21b2.js" defer></script><script src="/assets/js/3.5e4ac8fc.js" defer></script><script src="/assets/js/1.3c5103ae.js" defer></script><script src="/assets/js/14.1f60fcc8.js" defer></script>
  </body>
</html>
